---
title: tomcat压力测试
date: 2026-01-31 12:00:00 +0800
categories: [web服务器,tomcat]
tags: [tomcat tuning]
---
Apache JMeter是Apache组织开发的基于java的压力测试工具，用于对软件做压力测试，它最初被设计用于web应用测试，但后来扩展到其他测试领域。它可以用于测试静态和动态资源，例如静态文件、java小服务程序、CGI脚本、Java对象、数据库、FTP服务器等等。JMeter可以对服务器、网络或对象模拟巨大的负载，来自不同压力类别下测试它们的强度和分析整体性能。

**JMeter的作用**

可以对HTTP和FTP服务器进行压力和性能测试，也可以对任何数据库进行同样的测试（通过JDBC）。

完全的可移植性和100%纯Java。

完全多线程，框架运行通过多个线程并发取样和，通过单独的线程组对不同的功能同时取样。

精心的GUi设计允许快速操作和更精准的计时。

缓存和离线分析 / 回放测试结果。

下载地址：
https://jmeter.apache.org/download_jmeter.cgi


**JMeter安装使用**

将下载好的压缩包在Windows中解压（需要先安装JDK），解压后进入bin目录双击jmeter.bat，等待启动


如果要设置中文
在启动JMeter之前修改文件bin/jmeter.properties

找到这一行：
```
#language=en
```
改成：
```
language=zh_CN
```
保存修改后启动jmeter。

已经成为中文界面
![](/assets/img/Pasted image 20260203050529.png)



新建测试

http请求默认值

右键 测试计划>添加>配置元件>HTTP请求默认值
填写：

| 项     | 值              |
| ----- | -------------- |
| 协议    | http           |
| 服务器名称 | 192.168.22.128 |
| 端口号   | 8080           |

![](/assets/img/Pasted image 20260203172140.png)


模拟浏览器（有的网站需要）

右键 测试计划>添加>配置元件>HTTP header manager
![](/assets/img/Pasted image 20260203173256.png)


添加：

```
User-Agent: Mozilla/5.0
Accept: text/html
Accept-Language: zh-CN,zh;q=0.9
```

![](/assets/img/Pasted image 20260203173536.png)


添加线程组，使用线程模拟用户的并发

右键 测试计划>添加>线程>线程组
![](/assets/img/Pasted image 20260203173619.png)

| 参数                  | 值    |
| ------------------- | ---- |
| 线程数（用户数）            | 1000 |
| Ramp-Up 时间(加速/爬坡时间) | 20   |
| 循环次数                | 10   |
|                     |      |
总请求数 = 1000 x 10 = 10000
![](/assets/img/Pasted image 20260203173749.png)
Ramp-Up时间：在JMeter中指测试中逐渐增加并发用户数的时间。它表示从测试开始到达最大并发用户数所需要的时间。拿上面的配置来说，设置100个线程，Ramp-Up时间为20秒，则表示每秒增加 100 / 20 = 5 个用户，在20秒后达到100个并发用户。




添加并设置http请求

右键 线程组>添加>取样器>HTTP请求

填写
![](/assets/img/Pasted image 20260204155410.png)

添加监控

tomcat监控

聚合报告
线程组>添加>监听器>聚合报告


补充：
=========================================================
查看结果树

在压测之前可以使用测试以下，看看返回的响应。

线程组>添加>监听器>查看结果树

查看结果树会大量消耗CPU和内存，一般用来验证请求是否成功、排查故障和调试。在实际性能测试比如压测时，必须禁用或删掉它。

==========================================================

如果有需要也可以考虑监控系统的内存情况、CPU使用率、以及网络I/O


启动测试

查看结果

聚合报告指标分析

Label      请求类型。比如http、ftp请求

样本数(Samples)    表示本次测试总共发送了多少请求

平均值(Average) 平均响应时间，

中位数(Medium)  50%用户的响应时间

90% Line   90%用户响应时间

Min  最小响应时间
Max  最大响应时间

错误(Error%)  本次测试中请求的错误百分比

吞吐量(Throughput)  默认情况下表示服务端每单位时间完成的请求数

KB/Sec  每秒从服务端接收到的数据量

![](/assets/img/Pasted image 20260204170527.png)

总结分析：
- 本次压测总共发出10000个请求
- 响应时间：平均值2ms，中位数1ms，99%为18ms，最大值为32ms。分析：响应速度极快，99%的请求都在18ms内完成，因为我这里时在本地的局域网进行压测(在处理业务逻辑比较简单的地方也会有这种情况)。
- 异常率：为0%，非常理想，在1000并发下没有产生任何HTTP报错或超时。
- 吞吐量：496.4/Sec，在20秒的Ramp-up时间内，系统能够平稳处理每秒约497个请求。

注意：为保证单次压测结果不受干扰，如果之前有进行过压测，记得点击扫把标志清理，避免干扰数据准确性。

从上面测试可以看出，tomcat不做任何调整时，吞吐量为496.4/秒。这个吞吐量和接口的业务逻辑关系很大，如果比较复杂，需要比较长时间计算的，可能吞吐量只有几十次/秒，我这里是本地局域网 + 首页测试，所以吞吐量为496.4/秒。这里的吞吐量最好是经过多次测试取平均值，因为单次测试具有随机性。



