---
title: linux用户管理
date: 2026-02-10 22:00:00 +0800
categories: [Linux,系统管理]
tags: [Linux user manage]
---
**一、用户信息查询**

```
# 查看当前用户的信息
id

# 查看指定用户的信息
id username

# 查看谁在登录
who
w

# 查看当前登录用户
whoami
```

![](/assets/img/Pasted image 20260211002154.png)

root用户的uid、gid都是0



**二、用户账号管理**

用户账号信息文件：
```
#相关文件
    /etc/passwd
           用户账户信息。

       /etc/shadow
           安全用户账户信息。

       /etc/group
           组账户信息。

       /etc/gshadow
           安全组账户信息。

       /etc/default/useradd
           账户创建的默认值。

       /etc/skel/
           包含默认文件的目录。

       /etc/subgid
           Per user subordinate group IDs.

       /etc/subuid
           Per user subordinate user IDs.

       /etc/login.defs
           Shadow 密码套件配置。
```

2.1、useradd添加用户

```
-u 指定uid

-g 指定gid

-c 注释信息

-d 家目录

-s 指定shell

-G 附加组

-r 创建系统用户
```


示例：
```
useradd -u 1020 -g 1001 -c "this is a test user" -d /home/test1 -G games test1
```

/etc/passwd的内容格式：
```
USERNAME:PASSWORD:UID:GID:COMMENT:HOMEDIR:SHELL  

- USERNAME:用户识别名称，也是登录的名称
- PASSWORD：密码位，用于存储用户的密码，为了安全起见，密码放在另一个文件中，这里统一用x
- UID：用户识别号，0表示为管理员，非0为普通用户
- GID：组识别号，用来识别用户组的身份，同样0为管理员组，非0为系统群组或者自定义组
- COMMENT：描述信息
- HOMEDIR：家目录位置
- SHELL：shell类型
```


2.2、usermod修改用户
```
# 把用户名user1重命名为user2
usermod -l user1 user2

# 锁定用户user1
usermod -L user1

# 解锁user1
usermod -U user1

# 将user1添加到附加组test,如果不加-a，用户的附加组只会有新加的这一个，之前的都会退出
usermod -aG test user1
```



2.3、userdel删除用户

```
# 删除user1用户，但不删除其家目录和文件
userdel user1

# 删除user1用户以及它的家目录及文件
userdel -r user1

# -f 强制删除
```


2.4、passwd修改密码

```
# 修改当前用户的密码
passwd

# 修改user1的密码
passwd user1

# 查看user1用户密码状态
passwd -S user1
```


2.5、groupadd添加用户组

语法：
```
groupadd 用户组
```

参数：
- -g GID，指定用户组的gid
- -o，一般与-g参数同时使用，表示新用户组的gid可以与系统已有用户组的gid相同

```
groupadd test
groupadd -g 101 g1
```



2.6、groupdel删除用户组

语法：
```
groupdel 用户组
```


2.7、groupmod修改用户组属性

语法：
```
groupmod 用户组
```

常用参数：
- -g GID，为用户组指定新的gid
- -o与-g同时使用，用户组的新gid可以与系统已有用户组的gid相同
- -n 新用户组，将用户组名字改成新名字

```
groupmod -g 1001 -n group2 group1
```
此命令将组group1名字修改为group2,gid为1001。


2.8、su切换用户

```
# 切换为root用户并在执行完ls命令后退出变回原来用户
su -c ls root

# 切换为test用户，并将工作目录切换到test用户的家目录
su -test

# 切换到root用户
su root
```


2.9、sudo提权

sudo可以以其他身份来执行命令，默认是root。一般在执行普通用户不能执行的命令的时候使用。使用时需要输入用户正确的密码。


```
# 提升为root权限
sudo su 

# 列出目前用户权限
sudo -l
```

`/etc/sudoers`文件设置着可以执行sudo命令的用户，在该文件`haha ALL=(ALL) ALL`，保存并退出，此时haha用户已经具有sudo的所有权限。

如果要设置免密sudo
```
haha ALL=(ALL) NOPASSWD: ALL
```

