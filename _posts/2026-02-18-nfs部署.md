---
title: nfs部署
date: 2026-02-18 14:00:00 +0800
categories: [Linux,系统管理]
tags: [nfs]
---

nfs

网络文件系统

nfs是一种基于网络的文件共享协议，它允许客户端像访问本地目录一样访问远程服务器的目录。

nfs在OSI的会话层，2049号端口

准备两台Alma linux 虚拟机



**服务端**

```
dnf install -y nfs-utils
```

启动rpcbind，111端口，nfs本身没有网络传输功能，没有它nfs无法通信
```
systemctl enable --now rpcbind
```

启动nfs服务
```
systemctl enable --now nfs-server
```


创建文件共享目录
```
mkdir -p /data
```


修改权限
```
chmod 755 /data
```

配置nfs共享规则
```
vi /etc/exports
```
添加
```
# /data 要共享的目录
# 192.168.100.0./24 允许访问的客户端网段
# rw 允许读写，如果ro代表客户端只能读
# sync 数据同步写入磁盘，保证不丢数据
/data/ 192.168.100.0/24(rw,sync,no_root_squash)
```

使配置生效
```
# r重新加载，a导出全部，v显示详细信息
exportfs -rav
```

防火墙放行nfs服务
```
firewall-cmd --permanent --add-service=nfs
firewall-cmd --permanent --add-service=mountd   # mountd随机端口
firewall-cmd --permanent --add-service=rpc-bind
firewall-cmd --reload
```


关闭selinux
```
setenforce 0
```
selinux默认不允许随便导出目录


**客户端**

安装nfs
```
dnf install -y nfs-utils
```

创建挂载目录
```
mkdir /mnt/nfs
```

挂载
```
mount 服务端ip:/data/ /mnt/nfs
```

测试：
```
touch /mnt/nfs/test.txt
```

如果服务端目录`/data`中出现 test.txt，说明成功。



命令df可以查看挂载的目录
