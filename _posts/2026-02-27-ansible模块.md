---
title: ansible模块
date: 2026-02-27 12:00:00 +0800
categories: [ansible]
tags: [ansible modole]
---

**ansible模块文档**：<https://docs.ansible.com/projects/ansible/2.9/modules/list_of_all_modules.html>


ansible目前可用的模块有数千个，但常用的远没这么多


查看可用模块数量
```
ansible-doc -l | wc -l
```


查看某模块用法
```
ansible-doc -s <模块名>
```


## 一、ansible运维常用模块


**1.1、包管理模块**

apt/yum/dnf，用于安装、卸载软件。

编写剧本常用，安装或部署软件
```
- name: Install nginx
  apt:
    name: nginx
    state: present
  become: yes
```


**1.2、服务管理模块**

service/systemd，常用于启动、重启、设置开机自启、reload服务配置

```
- name: Start nginx
  systemd:
    name: nginx
    state: started
    enabled: yes
  become: yes
```



**1.3、文件管理模块**

copy，文件传输或拷贝

```
- copy:
    src: nginx.conf   # 当前目录文件
    dest: /etc/nginx/nginx.conf  # 目标位置
```


template（重要）
```
- template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
```


**1.4、用户管理模块**

user/group，批量创建系统用户，管理账户

```
- user:
    name: devops
    state: present
```


**1.5、git模块(CI/CD)**

git，拉取代码、自动部署应用、滚动更新
```
- git:
    repo: https://github.com/example/app.git
    dest: /opt/app
    version: master
```



**1.6、**docker模块

community.docker.docker_container，批量部署、更新、管理容器

```
- name: Run nginx container
  community.docker.docker_container:
    name: web
    image: nginx
    state: started
    ports:
      - "80:80"
```


**1.7、k8s模块**

kubernetes.core.k8s，用于操作：
- Deployment
- Service
- ConfigMap
- Namespace



## 二、ansible常见安全模块

**2.1、防火墙管理模块**

firewalld

```
- firewalld:
    port: 80/tcp
    permanent: yes
    state: enabled
  become: yes
```


**2.2、selinux管理模块**

selinux

```
- selinux:
    state: enforcing
```


**2.3、系统安全加固模块**

lineinfile，修改系统配置文件

比如：
```
- lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '^PermitRootLogin'
    line: 'PermitRootLogin no'
  become: yes
```


**2.4、文件权限控制**

file
```
- file:
    path: /etc/passwd
    mode: '0644'
```


**2.5、安全补丁更新**

批量打补丁、应急漏洞修复

```
- name: Update all packages
  apt:
    upgrade: dist
  become: yes
```


## 三、即时命令调用模块

有些时候直接使用命令比写playbook更方便

命令语法
```
# ansible <组名> -m <模块名> -a "<参数>"
ansible web -i hosts -m shell -a "free -m"
```


